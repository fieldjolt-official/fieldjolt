model Organization {
    id   String @id @default(cuid(2))
    name String
    slug String @unique

    createdAt DateTime
    updatedAt DateTime

    users OrganizationMember[]
    roles OrganizationRole[]
    teams OrganizationTeam[]

    @@index([slug])
    @@map("organizations")
}

model OrganizationMember {
    id String @id @default(cuid(2))

    createdAt DateTime
    updatedAt DateTime

    organizationId String
    organization   Organization @relation(fields: [organizationId], references: [id])

    userId String
    user   User   @relation(fields: [userId], references: [id])

    roleId String
    role   OrganizationRole @relation(fields: [roleId], references: [id])

    teamId String?
    team   OrganizationTeam? @relation(fields: [teamId], references: [id])

    @@unique([organizationId, userId])
    @@index([userId])
    @@index([organizationId])
    @@index([roleId])
    @@map("organization_members")
}

model OrganizationRole {
    id   String @id @default(cuid(2))
    name String

    permissions String[]

    isDefault Boolean @default(false)

    createdAt DateTime
    updatedAt DateTime

    organizationId String
    organization   Organization @relation(fields: [organizationId], references: [id])

    users OrganizationMember[]

    @@map("organization_roles")
}

model OrganizationTeam {
    id    String  @id @default(cuid(2))
    name  String
    icon  String?
    color String?

    createdAt DateTime
    updatedAt DateTime

    organizationId String
    organization   Organization @relation(fields: [organizationId], references: [id])

    users OrganizationMember[]

    @@index([organizationId])
    @@map("organization_teams")
}
